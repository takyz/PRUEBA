"use strict";angular.module("shoutoutGetSubscriberAppInternal",["shoutoutGetSubscriberCommon"]),angular.module("shoutoutGetSubscriberApp",["shoutoutGetSubscriberAppInternal","shoutoutGetSubscriberTranslations","wixAngular","wix.common.bi","pascalprecht.translate"]).config(["wixAngularTopologyProvider","$translateProvider",function(a,b){setTimeout(function(){var c=a.getStaticsUrl()+"scripts/locale/get-subscribers/messages_";b.useStaticFilesLoader({prefix:c,suffix:".json"})},0)}]),angular.module("shoutoutGetSubscriberCommonInternal",["LocalStorageModule","ngLodash"]).config(["localStorageServiceProvider",function(a){a.setPrefix("ls").setStorageType("localStorage")}]).run(["settingsManager",function(a){}]),angular.module("shoutoutGetSubscriberCommon",["shoutoutGetSubscriberCommonInternal","shoutoutGetSubscriberTranslations","so.gs.bi","wixAngular","wix.common.bi"]).config(["$httpProvider",function(a){a.interceptors.push("httpInterceptors")}]),angular.module("so.gs.bi.internal",[]),angular.module("so.gs.bi",["so.gs.bi.internal","shoutoutGetSubscriberTranslations","wixAngular","wix.common.bi"]);var AppController=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this;this.settingsManager=a,this.$scope=b,this.$window=c,this.$rootScope=d,this.$translate=e,this.Constants=f,this.$timeout=g,this.PhonePrefixes=h,this.gsLocalStorage=i,this.lodash=j,this.getSubscribersApi=k,this.MixpanelService=l,this.MixpanelEvents=m,this.requiredFieldsFilledIn=!0,this.hideForm=!0,this.subscribeIsSuccessful=!1,this.language="En",this.$window=c,this.phones=h.PREFIXES,a.getSettings().then(function(a){n.initializeSettings(a),n.settings=a,n.setSuggestedPhonePrefix(),n.checkLanguage(a.language),n.checkPopup(),n.$rootScope.$emit("resizeApp",n.subscribeIsSuccessful),n.hideForm=!1}),a.subscribeToSettingsUpdate(function(a){n.checkLanguage(a.language||n.language),a.style&&(n.settings.style=a.style),a.generalSettings&&(n.settings.generalSettings=a.generalSettings,n.setSuggestedPhonePrefix()),a.signupForm&&(n.settings.signupForm=a.signupForm),a.popup&&(n.settings.popup=a.popup),n.userWantsToDisplayPopupPreview(a)&&n.setWidgetParamsToStorage(),n.$rootScope.$emit("resizeApp",n.subscribeIsSuccessful),n.$scope.$apply()}),b.$watch("main.subscriberEmail",function(a){a&&!n.emailIsValid(a)?(n.validEmail=!1,n.requiredFieldsFilledIn=!1):(n.validEmail=!0,n.requiredFieldsFilledIn=!0)}),b.$watch("main.subscriberPhone",function(a){a&&!n.phoneIsValid(a)?(n.validPhone=!1,n.requiredFieldsFilledIn=!1):(n.validPhone=!0,n.requiredFieldsFilledIn=!0)}),b.$watch("main.subscriberName",function(a){a&&!n.nameIsValid(a)?(n.validName=!1,n.requiredFieldsFilledIn=!1):(n.validName=!0,n.requiredFieldsFilledIn=!0)}),b.$watch("main.requiredFieldsFilledIn",function(a,b){a===b||b||(n.showError=!1)})}return a.$inject=["settingsManager","$scope","$window","$rootScope","$translate","Constants","$timeout","PhonePrefixes","gsLocalStorage","lodash","getSubscribersApi","MixpanelService","MixpanelEvents"],a.prototype.subscribe=function(){var a={email:this.subscriberEmail||null,phone:this.subscriberPhone?this.dialCode+this.subscriberPhone:null,name:this.subscriberName||null};this.requiredDataSupplied(a)&&this.addSubscriber(a)},a.prototype.closePopup=function(){this.$window.Wix.closeWindow()},a.prototype.getStyle=function(){try{return{skin:this.getStyleClass(this.settings.style.appStyle,this.Constants.APP_STYLE,""),layout:this.isInMobile()||this.isInPopup()?"layout-vertical":this.getStyleClass(this.settings.signupForm.layout,this.Constants.APP_LAYOUT,"layout-"),headerAlignment:this.getStyleClass(this.settings.style.headerAlignment,this.Constants.HEADER_ALIGNMENT,"align-header-"),bodyAlignment:this.getStyleClass(this.settings.style.bodyAlignment,this.Constants.BODY_ELEMENT_ALIGNMENT,"align-body-"),buttonAlignment:this.getStyleClass(this.settings.style.buttonAlignment,this.Constants.BODY_ELEMENT_ALIGNMENT,"align-button-")}}catch(a){return{skin:"strip",layout:"layout-vertical",headerAlignment:"align-header-left",bodyAlignment:"align-body-left",buttonAlignment:"align-button-left"}}},a.prototype.popupBackground=function(){return this.isInPopup()?"in-popup":""},a.prototype.isInNeedOfUpgrade=function(){return!1},a.prototype.isInEditorOrPreviewMode=function(){return this.isInEditor()||"preview"===this.$window.Wix.Utils.getViewMode()},a.prototype.returnToForm=function(){var a=this;this.subscribeIsSuccessful=!1,this.isInPopup()&&this.closePopup(),this.$timeout(function(){a.$rootScope.$emit("resizeApp",a.subscribeIsSuccessful)},0)},a.prototype.isPreview=function(){return!(this.$window.location.search.indexOf("&preview=true")===-1)},a.prototype.hideFormIfPopupIsOpen=function(){return!this.isInPopup()&&this.hideForm},a.prototype.setSuggestedPhonePrefix=function(){var a=this;this.settings.generalSettings.collectPhone&&this.getSubscribersApi.getUserLocationByIp().then(function(b){a.dialCode=a.getDialCode(b.data.locationCode,a.PhonePrefixes)})},a.prototype.getStyleClass=function(a,b,c){return c+this.lodash.invert(b)[a].toString().toLowerCase().replace("_","-")},a.prototype.emailIsValid=function(a){var b=/^\b[a-zA-Z0-9.!#$%&â€™*+\/=?^_`{|}~-]{1,50}@[a-zA-Z0-9-]{1,50}(?:\.[a-zA-Z0-9-]{2,20})+$/;return b.test(a)},a.prototype.phoneIsValid=function(a){var b=/^\d+$/;return b.test(a)},a.prototype.nameIsValid=function(a){var b=/(<([^>]+)>)/gi;return!b.test(a)},a.prototype.requiredDataSupplied=function(a){(this.settings.generalSettings.nameRequired&&!a.name||!this.validName)&&(this.showError=!0,this.validName=!1),(this.settings.generalSettings.phoneRequired&&!a.phone||!this.validPhone)&&(this.showError=!0,this.validPhone=!1),a.email&&this.validEmail||(this.showError=!0,this.validEmail=!1);var b=!0,c=[{requirementSetting:this.settings.generalSettings.nameRequired,flag:this.validName},{requirementSetting:this.settings.generalSettings.phoneRequired,flag:this.validPhone},{requirementSetting:b,flag:this.validEmail}];return this.mandatoryFieldsFilledIn(c)&&!this.showError?(this.showError=!1,!0):(this.showError=!0,this.requiredFieldsFilledIn=!1,!1)},a.prototype.mandatoryFieldsFilledIn=function(a){var b=a.filter(function(a){return!a.requirementSetting||a.flag});return a.length===b.length},a.prototype.addSubscriber=function(a){var b=this;this.$window.Wix.Activities.getUserSessionToken(function(c){b.MixpanelService.trackEvent(b.MixpanelEvents.SUBSCRIBE),b.getSubscribersApi.subscribe(a,b.settings.generalSettings.subscriptionNotifications,c).then(function(a){b.subscribeIsSuccessful=!0,b.clearFields(),b.$rootScope.$emit("resizeApp",b.subscribeIsSuccessful),b.isInPopup()&&b.gsLocalStorage.markUserSubscribedThroughPopup()}).catch(function(a){b.subscribeIsSuccessful=!1})})},a.prototype.getDialCode=function(a,b){var c=b.PREFIXES.filter(function(b){return b.code===a});return c[0].dialCode},a.prototype.initializeSettings=function(a){this.style=a.style,this.generalSettings=a.generalSettings,this.signupForm=a.signupForm,this.popup=a.popup},a.prototype.setWidgetParamsToStorage=function(){this.gsLocalStorage.putWidgetUrlToStorage(),this.gsLocalStorage.putWidgetHeight(this.$window.innerHeight),this.gsLocalStorage.putWidgetWidth(this.$window.innerWidth)},a.prototype.userWantsToDisplayPopupPreview=function(a){return this.lodash.has(a,"openPopupPreview")&&a.openPopupPreview},a.prototype.executePopupOptions=function(){this.hideForm=!0,this.gsLocalStorage.setPopupHasBeenShownFlag()},a.prototype.openPopup=function(a){var b=this,c=this.$window.location.href+"&inModal=true",d=this.$window.innerWidth+50,e=d>=400?d:400,f=800,g=this.$window.Wix.Theme.BARE;this.$timeout(function(){b.$window.Wix.openModal(c,e,f,function(){b.settings.popup.hideFormIfSubscribedViaPopup&&b.gsLocalStorage.userSubscribedThroughPopup()||(b.hideForm=!1,b.$scope.$digest())},g),b.executePopupOptions()},1e3*a)},a.prototype.needToOpenPopup=function(){return!(this.isInEditor()||!this.settings.popup.showPopup||this.isInPopup()||this.isInMobile()||this.gsLocalStorage.userSubscribedThroughPopup()||!this.settings.popup.showPopupOnEveryVisitForNonSubscriber&&this.gsLocalStorage.userSubscribedThroughPopup()||!this.settings.popup.showPopupOnEveryVisitForNonSubscriber&&this.gsLocalStorage.popupHasAlreadyBeenShown())},a.prototype.isInEditor=function(){return"editor"===this.$window.Wix.Utils.getViewMode()},a.prototype.isInPopup=function(){return this.$window.location.search.indexOf("&inModal=true")!==-1},a.prototype.isInMobile=function(){return"mobile"===this.$window.Wix.Utils.getDeviceType()},a.prototype.checkPopup=function(){this.needToOpenPopup()&&this.openPopup(this.popup.popupTimer)},a.prototype.checkLanguage=function(a){var b=this;this.language!==a&&this.$translate.use(a.toLowerCase()).then(function(){b.$translate.refresh(),b.language=a})},a.prototype.clearFields=function(){this.subscriberEmail=null,this.subscriberName=null,this.subscriberPhone=null},a}();angular.module("shoutoutGetSubscriberAppInternal").directive("getSubscribers",["settingsManager",function(a){return{restrict:"E",templateUrl:"modules/widget/main.html",controller:AppController,controllerAs:"main"}}]),angular.module("shoutoutGetSubscriberAppInternal").directive("resize",["$window","$timeout","$rootScope","$q","Constants","settingsManager","lodash",function(a,b,c,d,e,f,g){return{restrict:"A",link:function(h,i){function j(a){if(!m()){if(i.outerHeight()<10)return void s();if(f&&f.settings&&f.settings.style){var b=f.settings.style.appStyle;a?t[f.isHorizontalLayout()?"horizontal":"vertical"]().then(function(a){"congrats-screen"===a.element&&p.setHeight(a.elementHeight+k(b))}):p.setHeight(i.outerHeight()+k(b))}}}function k(a){switch(a){case e.APP_STYLE.POSTCARD:return 23;case e.APP_STYLE.ELEGANT:return 20;default:return 0}}function l(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(var c in b)if(!(c in a)||a[c]!==b[c])return!1;return!0}function m(){return a.location.search.indexOf("&inModal=true")!==-1}function n(){return d(function(c){b(function(){c({elementHeight:angular.element(a.document.getElementsByClassName("overlay-view-wrapper").item(0)).outerHeight(),element:"congrats-screen"})},1)})}function o(){return d(function(c){b(function(){c({elementHeight:angular.element(a.document.getElementsByTagName("body").item(0)).outerHeight(),element:"body"})},3e3)})}var p=a.Wix,q={textFont:{},numbers:{}},r=i.outerHeight(),s=g.throttle(j,350),t={horizontal:n,vertical:o};h.$watch(function(){s()}),c.$on("resizeApp",function(a,b){j(b)}),p.addEventListener(p.Events.STYLE_PARAMS_CHANGE,function(a){(l(a.numbers,q.numbers)||l(a.textFont,q.textFont))&&(j(!1),q=a)}),a.addEventListener("resize",function(){r!==a.innerHeight&&j(!1),r=a.innerHeight})}}}]);var PhonePrefixes=function(){function a(){this.PREFIXES=[{name:"Afghanistan",dialCode:"+93",code:"AF"},{name:"Albania",dialCode:"+355",code:"AL"},{name:"Algeria",dialCode:"+213",code:"DZ"},{name:"AmericanSamoa",dialCode:"+1 684",code:"AS"},{name:"Andorra",dialCode:"+376",code:"AD"},{name:"Angola",dialCode:"+244",code:"AO"},{name:"Anguilla",dialCode:"+1 264",code:"AI"},{name:"Antigua and Barbuda",dialCode:"+1268",code:"AG"},{name:"Argentina",dialCode:"+54",code:"AR"},{name:"Armenia",dialCode:"+374",code:"AM"},{name:"Aruba",dialCode:"+297",code:"AW"},{name:"Australia",dialCode:"+61",code:"AU"},{name:"Austria",dialCode:"+43",code:"AT"},{name:"Azerbaijan",dialCode:"+994",code:"AZ"},{name:"Bahamas",dialCode:"+1 242",code:"BS"},{name:"Bahrain",dialCode:"+973",code:"BH"},{name:"Bangladesh",dialCode:"+880",code:"BD"},{name:"Barbados",dialCode:"+1 246",code:"BB"},{name:"Belarus",dialCode:"+375",code:"BY"},{name:"Belgium",dialCode:"+32",code:"BE"},{name:"Belize",dialCode:"+501",code:"BZ"},{name:"Benin",dialCode:"+229",code:"BJ"},{name:"Bermuda",dialCode:"+1 441",code:"BM"},{name:"Bhutan",dialCode:"+975",code:"BT"},{name:"Bosnia and Herzegovina",dialCode:"+387",code:"BA"},{name:"Botswana",dialCode:"+267",code:"BW"},{name:"Brazil",dialCode:"+55",code:"BR"},{name:"British Indian Ocean Territory",dialCode:"+246",code:"IO"},{name:"Bulgaria",dialCode:"+359",code:"BG"},{name:"Burkina Faso",dialCode:"+226",code:"BF"},{name:"Burundi",dialCode:"+257",code:"BI"},{name:"Cambodia",dialCode:"+855",code:"KH"},{name:"Cameroon",dialCode:"+237",code:"CM"},{name:"Canada",dialCode:"+1",code:"CA"},{name:"Cape Verde",dialCode:"+238",code:"CV"},{name:"Cayman Islands",dialCode:"+ 345",code:"KY"},{name:"Central African Republic",dialCode:"+236",code:"CF"},{name:"Chad",dialCode:"+235",code:"TD"},{name:"Chile",dialCode:"+56",code:"CL"},{name:"China",dialCode:"+86",code:"CN"},{name:"Christmas Island",dialCode:"+61",code:"CX"},{name:"Colombia",dialCode:"+57",code:"CO"},{name:"Comoros",dialCode:"+269",code:"KM"},{name:"Congo",dialCode:"+242",code:"CG"},{name:"Cook Islands",dialCode:"+682",code:"CK"},{name:"Costa Rica",dialCode:"+506",code:"CR"},{name:"Croatia",dialCode:"+385",code:"HR"},{name:"Cuba",dialCode:"+53",code:"CU"},{name:"Cyprus",dialCode:"+357",code:"CY"},{name:"Czech Republic",dialCode:"+420",code:"CZ"},{name:"Denmark",dialCode:"+45",code:"DK"},{name:"Djibouti",dialCode:"+253",code:"DJ"},{name:"Dominica",dialCode:"+1 767",code:"DM"},{name:"Dominican Republic",dialCode:"+1 849",code:"DO"},{name:"Ecuador",dialCode:"+593",code:"EC"},{name:"Egypt",dialCode:"+20",code:"EG"},{name:"El Salvador",dialCode:"+503",code:"SV"},{name:"Equatorial Guinea",dialCode:"+240",code:"GQ"},{name:"Eritrea",dialCode:"+291",code:"ER"},{name:"Estonia",dialCode:"+372",code:"EE"},{name:"Ethiopia",dialCode:"+251",code:"ET"},{name:"Faroe Islands",dialCode:"+298",code:"FO"},{name:"Fiji",dialCode:"+679",code:"FJ"},{name:"Finland",dialCode:"+358",code:"FI"},{name:"France",dialCode:"+33",code:"FR"},{name:"French Guiana",dialCode:"+594",code:"GF"},{name:"French Polynesia",dialCode:"+689",code:"PF"},{name:"Gabon",dialCode:"+241",code:"GA"},{name:"Gambia",dialCode:"+220",code:"GM"},{name:"Georgia",dialCode:"+995",code:"GE"},{name:"Germany",dialCode:"+49",code:"DE"},{name:"Ghana",dialCode:"+233",code:"GH"},{name:"Gibraltar",dialCode:"+350",code:"GI"},{name:"Greece",dialCode:"+30",code:"GR"},{name:"Greenland",dialCode:"+299",code:"GL"},{name:"Grenada",dialCode:"+1 473",code:"GD"},{name:"Guadeloupe",dialCode:"+590",code:"GP"},{name:"Guam",dialCode:"+1 671",code:"GU"},{name:"Guatemala",dialCode:"+502",code:"GT"},{name:"Guinea",dialCode:"+224",code:"GN"},{name:"Guinea-Bissau",dialCode:"+245",code:"GW"},{name:"Guyana",dialCode:"+592",code:"GY"},{name:"Haiti",dialCode:"+509",code:"HT"},{name:"Honduras",dialCode:"+504",code:"HN"},{name:"Hungary",dialCode:"+36",code:"HU"},{name:"Iceland",dialCode:"+354",code:"IS"},{name:"India",dialCode:"+91",code:"IN"},{name:"Indonesia",dialCode:"+62",code:"ID"},{name:"Iraq",dialCode:"+964",code:"IQ"},{name:"Ireland",dialCode:"+353",code:"IE"},{name:"Israel",dialCode:"+972",code:"IL"},{name:"Italy",dialCode:"+39",code:"IT"},{name:"Jamaica",dialCode:"+1 876",code:"JM"},{name:"Japan",dialCode:"+81",code:"JP"},{name:"Jordan",dialCode:"+962",code:"JO"},{name:"Kazakhstan",dialCode:"+7 7",code:"KZ"},{name:"Kenya",dialCode:"+254",code:"KE"},{name:"Kiribati",dialCode:"+686",code:"KI"},{name:"Kuwait",dialCode:"+965",code:"KW"},{name:"Kyrgyzstan",dialCode:"+996",code:"KG"},{name:"Latvia",dialCode:"+371",code:"LV"},{name:"Lebanon",dialCode:"+961",code:"LB"},{name:"Lesotho",dialCode:"+266",code:"LS"},{name:"Liberia",dialCode:"+231",code:"LR"},{name:"Liechtenstein",dialCode:"+423",code:"LI"},{name:"Lithuania",dialCode:"+370",code:"LT"},{name:"Luxembourg",dialCode:"+352",code:"LU"},{name:"Madagascar",dialCode:"+261",code:"MG"},{name:"Malawi",dialCode:"+265",code:"MW"},{name:"Malaysia",dialCode:"+60",code:"MY"},{name:"Maldives",dialCode:"+960",code:"MV"},{name:"Mali",dialCode:"+223",code:"ML"},{name:"Malta",dialCode:"+356",code:"MT"},{name:"Marshall Islands",dialCode:"+692",code:"MH"},{name:"Martinique",dialCode:"+596",code:"MQ"},{name:"Mauritania",dialCode:"+222",code:"MR"},{name:"Mauritius",dialCode:"+230",code:"MU"},{name:"Mayotte",dialCode:"+262",code:"YT"},{name:"Mexico",dialCode:"+52",code:"MX"},{name:"Monaco",dialCode:"+377",code:"MC"},{name:"Mongolia",dialCode:"+976",code:"MN"},{name:"Montenegro",dialCode:"+382",code:"ME"},{name:"Montserrat",dialCode:"+1664",code:"MS"},{name:"Morocco",dialCode:"+212",code:"MA"},{name:"Myanmar",dialCode:"+95",code:"MM"},{name:"Namibia",dialCode:"+264",code:"NA"},{name:"Nauru",dialCode:"+674",code:"NR"},{name:"Nepal",dialCode:"+977",code:"NP"},{name:"Netherlands",dialCode:"+31",code:"NL"},{name:"Netherlands Antilles",dialCode:"+599",code:"AN"},{name:"New Caledonia",dialCode:"+687",code:"NC"},{name:"New Zealand",dialCode:"+64",code:"NZ"},{name:"Nicaragua",dialCode:"+505",code:"NI"},{name:"Niger",dialCode:"+227",code:"NE"},{name:"Nigeria",dialCode:"+234",code:"NG"},{name:"Niue",dialCode:"+683",code:"NU"},{name:"Norfolk Island",dialCode:"+672",code:"NF"},{name:"Northern Mariana Islands",dialCode:"+1 670",code:"MP"},{name:"Norway",dialCode:"+47",code:"NO"},{name:"Oman",dialCode:"+968",code:"OM"},{name:"Pakistan",dialCode:"+92",code:"PK"},{name:"Palau",dialCode:"+680",code:"PW"},{name:"Panama",dialCode:"+507",code:"PA"},{name:"Papua New Guinea",dialCode:"+675",code:"PG"},{name:"Paraguay",dialCode:"+595",code:"PY"},{name:"Peru",dialCode:"+51",code:"PE"},{name:"Philippines",dialCode:"+63",code:"PH"},{name:"Poland",dialCode:"+48",code:"PL"},{name:"Portugal",dialCode:"+351",code:"PT"},{name:"Puerto Rico",dialCode:"+1 787",code:"PR"},{name:"Puerto Rico",dialCode:"+1 939",code:"PR"},{name:"Qatar",dialCode:"+974",code:"QA"},{name:"Romania",dialCode:"+40",code:"RO"},{name:"Rwanda",dialCode:"+250",code:"RW"},{name:"Samoa",dialCode:"+685",code:"WS"},{name:"San Marino",dialCode:"+378",code:"SM"},{name:"Saudi Arabia",dialCode:"+966",code:"SA"},{name:"Senegal",dialCode:"+221",code:"SN"},{name:"Serbia",dialCode:"+381",code:"RS"},{name:"Seychelles",dialCode:"+248",code:"SC"},{name:"Sierra Leone",dialCode:"+232",code:"SL"},{name:"Singapore",dialCode:"+65",code:"SG"},{name:"Slovakia",dialCode:"+421",code:"SK"},{name:"Slovenia",dialCode:"+386",code:"SI"},{name:"Solomon Islands",dialCode:"+677",code:"SB"},{name:"South Africa",dialCode:"+27",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",dialCode:"+500",code:"GS"},{name:"Spain",dialCode:"+34",code:"ES"},{name:"Sri Lanka",dialCode:"+94",code:"LK"},{name:"Sudan",dialCode:"+249",code:"SD"},{name:"Suriname",dialCode:"+597",code:"SR"},{name:"Swaziland",dialCode:"+268",code:"SZ"},{name:"Sweden",dialCode:"+46",code:"SE"},{name:"Switzerland",dialCode:"+41",code:"CH"},{name:"Tajikistan",dialCode:"+992",code:"TJ"},{name:"Thailand",dialCode:"+66",code:"TH"},{name:"Togo",dialCode:"+228",code:"TG"},{name:"Tokelau",dialCode:"+690",code:"TK"},{name:"Tonga",dialCode:"+676",code:"TO"},{name:"Trinidad and Tobago",dialCode:"+1 868",code:"TT"},{name:"Tunisia",dialCode:"+216",code:"TN"},{name:"Turkey",dialCode:"+90",code:"TR"},{name:"Turkmenistan",dialCode:"+993",code:"TM"},{name:"Turks and Caicos Islands",dialCode:"+1 649",code:"TC"},{name:"Tuvalu",dialCode:"+688",code:"TV"},{name:"Uganda",dialCode:"+256",code:"UG"},{name:"Ukraine",dialCode:"+380",code:"UA"},{name:"United Arab Emirates",dialCode:"+971",code:"AE"},{name:"UK",dialCode:"+44",code:"GB"},{name:"USA",dialCode:"+1",code:"US"},{name:"Uruguay",dialCode:"+598",code:"UY"},{name:"Uzbekistan",dialCode:"+998",code:"UZ"},{name:"Vanuatu",dialCode:"+678",code:"VU"},{name:"Wallis and Futuna",dialCode:"+681",code:"WF"},{name:"Yemen",dialCode:"+967",code:"YE"},{name:"Zambia",dialCode:"+260",code:"ZM"},{name:"Zimbabwe",dialCode:"+263",code:"ZW"},{name:"Bolivia, Plurinational State of",dialCode:"+591",code:"BO"},{name:"Brunei Darussalam",dialCode:"+673",code:"BN"},{name:"Cocos (Keeling) Islands",dialCode:"+61",code:"CC"},{name:"Congo, The Democratic Republic of the",dialCode:"+243",code:"CD"},{name:"Cote d'Ivoire",dialCode:"+225",code:"CI"},{name:"Falkland Islands (Malvinas)",dialCode:"+500",code:"FK"},{name:"Guernsey",dialCode:"+44",code:"GG"},{name:"Holy See (Vatican City State)",dialCode:"+379",code:"VA"},{name:"Hong Kong",dialCode:"+852",code:"HK"},{name:"Iran, Islamic Republic of",dialCode:"+98",code:"IR"},{name:"Isle of Man",dialCode:"+44",code:"IM"},{name:"Jersey",dialCode:"+44",code:"JE"},{name:"Korea, Democratic People's Republic of",dialCode:"+850",code:"KP"},{name:"Korea, Republic of",dialCode:"+82",code:"KR"},{name:"Lao People's Democratic Republic",dialCode:"+856",code:"LA"},{name:"Libyan Arab Jamahiriya",dialCode:"+218",code:"LY"},{name:"Macao",dialCode:"+853",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",dialCode:"+389",code:"MK"},{name:"Micronesia, Federated States of",dialCode:"+691",code:"FM"},{name:"Moldova, Republic of",dialCode:"+373",code:"MD"},{name:"Mozambique",dialCode:"+258",code:"MZ"},{name:"Palestinian Territory, Occupied",dialCode:"+970",code:"PS"},{name:"Pitcairn",dialCode:"+872",code:"PN"},{name:"RÃ©union",dialCode:"+262",code:"RE"},{name:"Russia",dialCode:"+7",code:"RU"},{name:"Saint BarthÃ©lemy",dialCode:"+590",code:"BL"},{name:"Saint Helena, Ascension and Tristan Da Cunha",dialCode:"+290",code:"SH"},{name:"Saint Kitts and Nevis",dialCode:"+1 869",code:"KN"},{name:"Saint Lucia",dialCode:"+1 758",code:"LC"},{name:"Saint Martin",dialCode:"+590",code:"MF"},{name:"Saint Pierre and Miquelon",dialCode:"+508",code:"PM"},{name:"Saint Vincent and the Grenadines",dialCode:"+1 784",code:"VC"},{name:"Sao Tome and Principe",dialCode:"+239",code:"ST"},{name:"Somalia",dialCode:"+252",code:"SO"},{name:"Svalbard and Jan Mayen",dialCode:"+47",code:"SJ"},{name:"Syrian Arab Republic",dialCode:"+963",code:"SY"},{name:"Taiwan, Province of China",dialCode:"+886",code:"TW"},{name:"Tanzania, United Republic of",dialCode:"+255",code:"TZ"},{name:"Timor-Leste",dialCode:"+670",code:"TL"},{name:"Venezuela, Bolivarian Republic of",dialCode:"+58",code:"VE"},{name:"Viet Nam",dialCode:"+84",code:"VN"},{name:"Virgin Islands, British",dialCode:"+1 284",code:"VG"},{name:"Virgin Islands, U.S.",dialCode:"+1 340",code:"VI"}]}return a}();angular.module("shoutoutGetSubscriberAppInternal").value("PhonePrefixes",new PhonePrefixes);var Constants=function(){function a(){this.APP_STYLE={CLASSIC:0,STRIP:1,POSTCARD:2,ELEGANT:3,HEADLINE:4},this.HEADER_ALIGNMENT={LEFT:0,CENTER:1,RIGHT:2},this.BODY_ELEMENT_ALIGNMENT={LEFT:0,RIGHT:1},this.APP_LAYOUT={HORIZONTAL:0,VERTICAL:1,OLD_HORIZONTAL:2}}return a}();angular.module("shoutoutGetSubscriberCommonInternal").value("Constants",new Constants);var DefaultSettings=function(){function a(){this.defaultSettings={version:10,language:"En",generalSettings:{subscriptionNotifications:!0,collectName:!1,collectPhone:!1,nameRequired:!1,phoneRequired:!1,namePlaceholder:"",phonePlaceholder:"",emailPlaceholder:""},signupForm:{showTitle:!0,showSubtitle:!0,titleText:"",subtitleText:"",buttonText:"",thankYouTitleText:"",thankYouSubtitleText:"",layout:1},popup:{showPopup:!1,showPopupOnEveryVisitForNonSubscriber:!0,hideFormIfSubscribedViaPopup:!0,popupTimer:5,showSubtitle:!0,popupTitleText:"",popupSubtitleText:"",popupButtonText:"",popupThankYouTitle:"",popupThankYouSubtitle:""},style:{appStyle:1,headerAlignment:0,bodyAlignment:0,buttonAlignment:1}}}return a}();angular.module("shoutoutGetSubscriberCommonInternal").value("defaultSettings",new DefaultSettings);var SettingsManager=function(){function a(a,b,c,d,e){var f=this;this.$window=a,this.lodash=b,this.$q=c,this.defaultSettings=d,this.getSubscribersApi=e,this.settingsExist=!1,this.settingsScope={scope:"COMPONENT"},this.currentVersion=10,this.subscribeToSettingsUpdate=function(a){f.$window.Wix.addEventListener(f.$window.Wix.Events.SETTINGS_UPDATED,function(b){f.callToOpenPopupPreview(b)?a(b):(f.settings=f.lodash.merge(f.settings,b),f.isOldApp=!1,f.saveSettings(),a(f.settings))})},this.saveSettings=b.debounce(this.saveSettngs,500)}return a.$inject=["$window","lodash","$q","defaultSettings","getSubscribersApi"],a.prototype.getSettings=function(){var a=this,b=this.$q.defer();return this.isAlreadyLoadedSettings(this.settings)?(b.resolve(this.settings),b.promise):this.$window.self===this.$window.top?(this.settings=this.defaultSettings.defaultSettings,b.resolve(this.settings),b.promise):(this.isInEditor()?this.checkEditorVersion().then(function(c){c?a.loadSettingsFromSite().then(function(c){a.isOldApp=!1,a.settingsExist=!0,a.settings=c,b.resolve(c)}).catch(function(c){a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,a.settings=c,b.resolve(c)}).catch(function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}):a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,a.settings=c,b.resolve(c)}).catch(function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}):this.loadSettingsFromSite().then(function(c){a.isOldApp=!1,a.settingsExist=!0,a.settings=c,b.resolve(c)}).catch(function(c){a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,a.settings=c,b.resolve(c)}).catch(function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}),b.promise)},a.prototype.hasSingleField=function(){return!this.settings.generalSettings.collectName&&!this.settings.generalSettings.collectPhone},a.prototype.isHorizontalLayout=function(){return 0===this.settings.signupForm.layout},a.prototype.checkEditorVersion=function(){var a=this.$q.defer();return this.$window.Wix.Features.isSupported(this.$window.Wix.Features.Types.ADD_COMPONENT,function(b){a.resolve(b)}),a.promise},a.prototype.loadSettingsFromSite=function(){var a=this.$q.defer();return this.$window.Wix.Data.Public.get("settings",this.settingsScope,function(b){a.resolve(b.settings)},function(b){a.reject(null)}),a.promise},a.prototype.loadSettingsFromServer=function(){var a=this,b=this.$q.defer();return this.getSubscribersApi.loadSettings().then(function(c){var d=c.data;d.style.appStyle>4&&(d.style.appStyle=a.determineStyle(d.style.appStyle)),d.signupForm.layout=a.determineLayout(d.signupForm.layout),b.resolve(d)}).catch(function(c){console.log("load defaults"),b.reject(a.defaultSettings.defaultSettings)}),b.promise},a.prototype.isInEditor=function(){var a=this.$window.Wix.Utils.getViewMode();return"editor"===a||"preview"===a||null===a},a.prototype.transformStringVariables=function(a,b){for(var c=b.length,d=0;d<c;d++)"boolean"!=typeof a[b[d]]||a[b[d]]||(a[b[d]]="");return a},a.prototype.saveSettngs=function(){var a=this;this.checkEditorVersion().then(function(b){b?a.$window.Wix.Data.Public.set("settings",a.settings,a.settingsScope,function(b){console.log("updateSettings"),a.isOldApp=!1},function(b){a.saveToDatabase()}):a.saveToDatabase()})},a.prototype.saveToDatabase=function(){var a=this.decodeInstance(this.getSubscribersApi.instance);this.settingsExist&&this.settings.instanceId===a.instanceId?(this.settings.signupForm.layout=this.mapToOldLayout(this.settings.signupForm.layout),this.getSubscribersApi.updateSettings(this.settings)):(this.settings.instanceId===a.originInstanceId&&(this.settings.instanceId=a.instanceId),this.settings.signupForm.layout=this.mapToOldLayout(this.settings.signupForm.layout),this.getSubscribersApi.saveSettings(this.settings),this.settingsExist=!0)},a.prototype.callToOpenPopupPreview=function(a){return this.lodash.has(a,"openPopupPreview")&&a.openPopupPreview},a.prototype.determineStyle=function(a){switch(a){case 10:return 0;case 16:return 1;case 12:return 2;case 13:return 3;case 14:return 4;default:return 1}},a.prototype.determineLayout=function(a){switch(a){case 1:return 1;case 4:return 2;case 0:return 0;default:return 1}},a.prototype.mapToOldLayout=function(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 4}},a.prototype.decodeInstance=function(a){var b=a.split(".")[1],c=this.$window.JSON.parse(this.$window.atob(b));return c},a.prototype.isAlreadyLoadedSettings=function(a){try{return!!(a&&a.generalSettings&&a.signupForm&&a.popup&&a.style)}catch(a){return!1}},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("settingsManager",SettingsManager);var GSLocalStorageService=function(){function a(a,b){this.localStorageService=a,this.$window=b,this.USER_REGISTERED="user-registered",this.WIDGET_URL="widget-url",this.WIDGET_HEIGHT="widget-height",this.WIDGET_WIDTH="widget-width",this.DONT_SHOW_POPUP="snooze-dirty"}return a.$inject=["localStorageService","$window"],a.prototype.markUserSubscribedThroughPopup=function(){this.localStorageService.set(this.getUserRegisteredKey(),!0)},a.prototype.putWidgetUrlToStorage=function(){this.localStorageService.set(this.WIDGET_URL,this.$window.location.href+"&inModal=true&preview=true")},a.prototype.getWidgetUrl=function(){var a=this.localStorageService.get(this.WIDGET_URL);return this.localStorageService.remove(this.WIDGET_URL),a},a.prototype.getWidgetHeight=function(){return this.localStorageService.get(this.WIDGET_HEIGHT)},a.prototype.getWidgetWidth=function(){return this.localStorageService.get(this.WIDGET_WIDTH)},a.prototype.putWidgetHeight=function(a){this.localStorageService.set(this.WIDGET_HEIGHT,a)},a.prototype.putWidgetWidth=function(a){this.localStorageService.set(this.WIDGET_WIDTH,a)},a.prototype.userSubscribedThroughPopup=function(){return!!this.localStorageService.get(this.getUserRegisteredKey())},a.prototype.setPopupHasBeenShownFlag=function(){this.localStorageService.set(this.getDontShowPopupKey(),!0)},a.prototype.popupHasAlreadyBeenShown=function(){return!!this.localStorageService.get(this.getDontShowPopupKey())},a.prototype.getDontShowPopupKey=function(){return this.DONT_SHOW_POPUP+":"+this.$window.Wix.Utils.getInstanceId()},a.prototype.getUserRegisteredKey=function(){return this.USER_REGISTERED+":"+this.$window.Wix.Utils.getInstanceId()},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("gsLocalStorage",GSLocalStorageService);var GetSubscribersApi=function(){function a(a,b,c){this.$http=a,this.$window=b,this.$location=c,this.compId=null,this.instance=null}return a.$inject=["$http","$window","$location"],a.prototype.subscribe=function(a,b,c){return this.$http({method:"POST",url:"api/contacts",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:a,params:{sendNotification:b,svSession:c}})},a.prototype.loadSettings=function(){return this.$http({method:"GET",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}})},a.prototype.saveSettings=function(a){return this.$http({method:"POST",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:a})},a.prototype.updateSettings=function(a){return this.$http({method:"PUT",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:a})},a.prototype.sendEmailToOwner=function(){return this.$http({method:"POST",url:"api/sendEmailToOwner",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}})},a.prototype.getUserLocationByIp=function(){return this.$http({method:"GET",url:"api/geoinfo",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}})},a.prototype.getInstance=function(){return this.instance||(this.instance=this.$location.absUrl().split("instance=")[1].split("&")[0]),this.instance},a.prototype.getCompId=function(){return this.compId||(this.compId=this.$window.Wix.Utils.getOrigCompId()||this.$window.Wix.Utils.getCompId()),this.compId},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("getSubscribersApi",GetSubscribersApi);var WixService=function(){function a(a){this.$window=a,this.wix=this.$window.Wix}return a.$inject=["$window"],a.prototype.getInstance=function(){return this.instance?this.instance:(this.instance=this.$window.location.search.split("instance=")[1].split("&")[0],this.instance);
},a.prototype.isInMobile=function(){return"mobile"===this.wix.Utils.getDeviceType()},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("wix",WixService);var Interceptors=function(){function a(){}return a.prototype.request=function(a){if(a.url.indexOf("api/")!==-1){var b="http://"+window.location.host+window.location.pathname.split("/static")[0];a.url=b+"/"+a.url}return a},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("httpInterceptors",Interceptors);var MixpanelEvents=function(){function a(){this.APP_SETTINGS_PAGE_LOAD={evtName:"APP_SETTINGS_PAGE_LOAD",options:{description:"settings view loaded"}},this.APP_SETTINGS_POPUP={ENABLE:{evtName:"APP_SETTINGS_POPUP",options:{description:"enable"}},DISABLE:{evtName:"APP_SETTINGS_POPUP",options:{description:"disable"}}},this.CHANGE_LAYOUT={HORIZONTAL:{evtName:"CHANGE_LAYOUT",options:{name:"side_layout"}},VERTICAL:{evtName:"CHANGE_LAYOUT",options:{name:"below_layout"}}},this.CHANGE_TEMPLATE={CLASSIC:{evtName:"CHANGE_TEMPLATE",options:{name:"Classic"}},STRIP:{evtName:"CHANGE_TEMPLATE",options:{name:"Strip"}},POSTCARD:{evtName:"CHANGE_TEMPLATE",options:{name:"Postcard"}},ELEGANT:{evtName:"CHANGE_TEMPLATE",options:{name:"Elegant"}},HEADLINE:{evtName:"CHANGE_TEMPLATE",options:{name:"Headline"}}},this.FORM_FIELD={NAME:{SWITCH:{ON:{evtName:"FORM_FIELD_NAME_SWITCH",options:{status:"on"}},OFF:{evtName:"FORM_FIELD_NAME_SWITCH",options:{status:"off"}}},MANDATORY:{ON:{evtName:"FORM_FIELD_NAME_MANDATORY",options:{status:"on"}},OFF:{evtName:"FORM_FIELD_NAME_MANDATORY",options:{status:"off"}}}},PHONE:{SWITCH:{ON:{evtName:"FORM_FIELD_MOBILE_SWITCH",options:{status:"on"}},OFF:{evtName:"FORM_FIELD_MOBILE_SWITCH",options:{status:"off"}}},MANDATORY:{ON:{evtName:"FORM_FIELD_MOBILE_MANDATORY",options:{status:"on"}},OFF:{evtName:"FORM_FIELD_MOBILE_MANDATORY",options:{status:"off"}}}}},this.POPUP_PREVIEW_CLICK={evtName:"POPUP_PREVIEW_CLICK",options:{description:"click"}},this.TRY_NOW={evtName:"SEND_BEAUTIFUL_NEWSLETTER",options:{description:"click button"}},this.SIGNUP_FORM_HEADER={ON:{evtName:"SIGNUP_FORM_TITLE_CHECKBOX_CLICK",options:{description:"enable"}},OFF:{evtName:"SIGNUP_FORM_TITLE_CHECKBOX_CLICK",options:{description:"disable"}}},this.OPEN_TAB={POPUP:{evtName:"TAB_CLICK_POPUP",options:{description:"click"}},SETTINGS:{evtName:"TAB_CLICK_SETTINGS",options:{description:"click"}},SIGNUP_FORM:{evtName:"TAB_CLICK_SIGNUP_FORM",options:{description:"click"}},STYLE:{evtName:"TAB_CLICK_STYLE",options:{description:"click"}},WELCOME_EMAIL:{evtName:"TAB_CLICK_WELCOME_EMAIL",options:{description:"click"}}},this.CREATE_WELCOME_EMAIL={evtName:"WELCOME_TAB_CREATE_CLICK",options:{description:"click"}},this.TEXT_CHANGE_FORM={TITLE:{evtName:"TEXT_CHANGE_FORM_TITLE",options:{}},SUBTITLE:{evtName:"TEXT_CHANGE_FORM_SUBTITLE",options:{}},BUTTON:{evtName:"TEXT_CHANGE_FORM_BUTTON",options:{}},THANK_YOU_TITLE:{evtName:"TEXT_CHANGE_FORM_THANK_YOU_TITLE",options:{}},THANK_YOU_SUBTITLE:{evtName:"TEXT_CHANGE_FORM_THANK_YOU_SUBTITLE",options:{}}},this.TEXT_CHANGE_POPUP={TITLE:{evtName:"TEXT_CHANGE_POPUP_TITLE",options:{}},SUBTITLE:{evtName:"TEXT_CHANGE_POPUP_SUBTITLE",options:{}},BUTTON:{evtName:"TEXT_CHANGE_POPUP_BUTTON",options:{}},THANK_YOU_TITLE:{evtName:"TEXT_CHANGE_POPUP_THANK_YOU_TITLE",options:{}},THANK_YOU_SUBTITLE:{evtName:"TEXT_CHANGE_POPUP_THANK_YOU_SUBTITLE",options:{}}},this.POPUP={VISIT_SETTING:{ON:{evtName:"POPUP_VISIT_SETTING_CHANGE",options:{status:"on"}},OFF:{evtName:"POPUP_VISIT_SETTING_CHANGE",options:{status:"off"}}},HIDE_FORM:{ON:{evtName:"POPUP_HIDE_FORM_SETTINGS_CHANGE",options:{status:"on"}},OFF:{evtName:"POPUP_HIDE_FORM_SETTINGS_CHANGE",options:{status:"off"}}}},this.SUBSCRIBE={evtName:"SUBSCRIBE_CLICK",options:{description:"user click subscribe"}}}return a}();angular.module("so.gs.bi.internal").constant("MixpanelEvents",new MixpanelEvents);var MixpanelService=function(){function a(a,b){this.$window=a,this.$log=b,this.mixpanel=this.$window.mixpanel}return a.$inject=["$window","$log"],a.prototype.trackEvent=function(a){this.$log.debug(a.evtName,a.options),this.mixpanel.track(a.evtName,a.options)},a}();angular.module("so.gs.bi.internal").service("MixpanelService",MixpanelService);